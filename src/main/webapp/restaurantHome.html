<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Restaurant</title>
  <link rel="stylesheet" href="home.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,300;0,400;1,400;1,700&family=Noto+Sans:ital,wght@0,400;0,500;0,600;1,700&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="reshome.css" >
</head>

<body>
  <div class="app" style="position: relative;">
    <div class="nav">
      <img src="logo.jpg" alt="" />
      <div class="products">
        <button onclick="handleAddItems()">Add items</button>
        <button onclick="viewOrder()">Orders</button>
        <button onclick="logout()">Logout</button>
      </div>
    </div>
    <div style="margin-top: 10px;;border: 1px solid #eeeeee;"></div>
    <div class="imagesSlider">
      <div class="wrapper" id="dwrapper">
        <div class="pimg">
          <img src="ck1.jpg">
        </div>
        <div class="pimg">
          <img src="ck2.jpg">
        </div>
        <div class="pimg">
          <img src="ck3.jpg">
        </div>
        <div class="pimg">
          <img src="ck4.jpg">
        </div>
      </div>
      <button class="next-btn"><span class="material-symbols-outlined">
          arrow_forward_ios
        </span></button>
      <button class="prev-btn"><span class="material-symbols-outlined">
          arrow_back_ios
        </span></button>
    </div>
    <div class="dwrapper" style="display: flex;align-items: center;justify-content: center;">
      <div class="details" style="width: 70%;display: flex;flex-direction: column;gap: 0;">
        <div class="Rtitle" style="display: flex;align-items: center;justify-content: space-between;height: 50px;">
          <p id="rname" style="font-size: 36px;color:#1c1c1c">Cake Zone</p>
          <div class="to" style="display: flex;align-items: center;gap:10px;">
            <p id="rrating" style="font-size: 15px;color: #fff;background-color: #24963f;padding: 3px 12px;border-radius: 10px;cursor: pointer;">3.6*</p>
            <p style="font-size: 13px;text-decoration: 1px dashed #d89898;">4000 reviews</p>
          </div>
        </div>
        <div class="type" style="height: 35px;">
          <p id="rhigh" style="color:#696969;font-size: 16px;">Bakery,Desserts,Mithai</p>
        </div>
        <div id="rloc" class="location" style="height: 35px;;margin-top:20px;color:#a7a6a6;font-size: 16px">
          <p>Vanagaram, Chennai</p>
        </div>
        <div class="menu" style="display: flex;align-items: center;height: 60px;margin-top: 10px;gap: 50px;">
          <div class="overview" style="color: #696969;font-size: 18px;cursor: pointer;">Overview</div>
          <div class="reviews" style="color: #696969;font-size: 18px;cursor: pointer;">Reviews</div>

        </div>
        <div style="border: 1px solid #e6e4e4;margin-bottom: 17px;"></div>
        <div class="dishes" id="dishesC" style="display: flex;flex-direction: column;gap: 30px;align-items: center;justify-content: center;">
          <div class="dish" style="display: flex;flex-direction: row;gap: 10px;cursor: pointer;">
            <p class="dname" style="font-size: 20px;font-weight: 800;">New year special coookie cake</p>
            <div class="info" style="color: #7c7c7c;">
              <p class="price">Rs.550</p>
              <p class="desc">Indulge in the sweetness of the New Year with the richness of our chocolate truffle cake, each bite is a journey into the rich chocolate goodness.</p>
              <p style="font-size: 15px;color: #fff;background-color: #24963f;width: 80px;;padding: 3px 12px;border-radius: 10px;height: 25px;">Add to cart</p>

            </div>

          </div>

        </div>
      </div>


    </div>
    <div class="fcontainer">

      <div class="footer" style="display: flex;flex-direction: column;">
        <div class="top" style="display: flex;align-items: center;justify-content: space-between;">
          <img src="logo.jpg">
          <div class="lc" style="display: flex;align-items: center;gap: 30px;">
            <p style="font-size: 16px;">India</p>
            <div class="language" style="display: flex;align-items: center;justify-content: center;border: 1px solid #dddbdb;gap: 6px;border-radius: 10px;width: 100px;height: 40px;">
              <span class="material-symbols-outlined">
                language
              </span>
              <p style="font-size: 16px;">English</p>
            </div>
          </div>
        </div>
        <div class="bottom">
          <div class="links">
            <p style="font-weight:800;">Social Links</p>
            <div class="limg">
              <img src="instagram.png" alt="">
              <img src="twitter.png" alt="">
              <img src="youtube.png" alt="">
            </div>
          </div>
          <div class="get">
            <img src="app.jpg" alt="">
            <img src="google.jpg" alt="">
          </div>
        </div>
        <div style="border: 1px solid #bab9b9;"></div>
      </div>
    </div>
    </div>
    <div id="addItem" class="additems dnone">
      <span class="material-symbols-outlined" style="font-size: 35px;color: rgb(205, 23, 23);position: absolute;top: 0px;right:5px;cursor: pointer;" onclick="handleclose()">
        close
        </span>
  <div class="atitle">
    <p style="font-size: 20px;color: white;font-weight: 800;">Add item</p>

  </div>
  <div class="ainp" style="display: flex;flex-direction: column;align-items: center;justify-content: center;gap: 20px;">
    <input type="text" id="itemname" placeholder="Name">
    <input type="text" id="itemprice" placeholder="Price">
    <textarea type="text" id="itemdesc" placeholder="Description"></textarea>
  </div>
  <div class="submit">
    <button onclick="additemstodb()">Add</button>
  </div>
    </div>
<script>
  function viewOrder(){
    window.location.href ="/ZomatoClone/orders.html";
  }
  function handleSuccess(){
    Swal.fire({
  position: "top-end",
  icon: "success",
  title: "added successfully",
  showConfirmButton: false,
  timer: 1000
}).then(()=>window.location.reload());
  }
  function additemstodb(){
var iname=document.getElementById("itemname").value;
var iprice=document.getElementById("itemprice").value;
var idesc=document.getElementById("itemdesc").value;
var data = iname + "/" + iprice + "/" + idesc;
    var old = window.localStorage.getItem("fooditems");
    if (old == null || old == undefined) {
      old = data;
    } else {
      old += "//" + data;
    }

    window.localStorage.setItem("fooditems", old);
  var xtp=new XMLHttpRequest();
  xtp.onreadystatechange=function(){
    if(this.readyState==4 && this.status==200){
      console.log(this.responseText);
      handleSuccess();
      handleclose();
  }
}


xtp.open("POST","http://localhost:8080/ZomatoClone/updateItems?items="+old+"&name="+JSON.parse(window.localStorage.getItem("currentRes"))[0].name,true);
xtp.setRequestHeader("Content-Type", "application/json");
 xtp.send();
 


  }
  function handleclose(){
    document.getElementById("addItem").classList.add("dnone");
  }
  function handleAddItems(){
document.getElementById("addItem").classList.remove("dnone");
  }
  function logout(){
    localStorage.clear();
    window.location.href="/ZomatoClone/login.html";
  }
        window.onload = function() {
            
      var restaurant = window.localStorage.getItem("currentRes");
      var n = JSON.parse(window.localStorage.getItem("currentRes"))[0].name;
      var resdetails = (JSON.parse(restaurant));
      document.getElementById("rhigh").textContent = resdetails[0].highlight;
      document.getElementById("rloc").textContent = resdetails[0].location;
      document.getElementById("rrating").textContent = resdetails[0].rating;

      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          console.log(JSON.parse(this.responseText));
          var h = JSON.parse(this.responseText);
          console.log(h);
          var it=(h[0].items)
          window.localStorage.setItem("fooditems",it);
          var items = (h[0].items).split("//");
          console.log(items);
          var dishesContainer = document.getElementById("dishesC");
          dishesContainer.innerHTML = "";
          document.getElementById("rname").textContent = h[0].name;
          items.forEach((item) => {
            var fooditem = (item.split("/"));
            var fname = fooditem[0]
            var fprice = fooditem[1]
            var fdesc = fooditem[2]

            var dish = document.createElement('div');
            dish.className = "dish";
            dish.style.display = "flex";
            dish.style.flexDirection = "row";
            dish.style.gap = "100px";
            dish.style.cursor = "pointer";
            dish.style.alignItems = "center";
            dish.style.width = "100%";
            dish.style.justifyContent = "flex-start";


            dish.innerHTML = `
      <p class="dname" style="font-size: 20px;font-weight: 800;width:150px">${fname}</p>
      <div style="display:flex;align-items:center;justify-content:center;float:left;margin-left:100px;">
                    <div class="info" style="color: #7c7c7c;width:500px" >
                        <p class="price">Rs.${fprice}</p>
                        <p class="desc">${fdesc}.</p>
                    </div>
      </div>
                    `;
            dishesContainer.appendChild(dish);

          })
        }
      }
      xhttp.open("GET", "http://localhost:8080/ZomatoClone/getfood?resname="+n, true);
      xhttp.send();
    }
    document.addEventListener("DOMContentLoaded", function() {
      var restaurant = window.localStorage.getItem("currentRes")
      var resdetails = JSON.parse(restaurant);
      console.log("esultt",resdetails)
      var disimages = resdetails[0].displayimages
      var images = disimages.split("/");
      var wrapperContainer = document.getElementById("dwrapper");
      wrapperContainer.innerHTML = "";
      images.forEach((image) => {
        var pimg = document.createElement("div");
        pimg.className = "pimg";
        pimg.innerHTML = ` <img src="${image}">`
        wrapperContainer.appendChild(pimg);
      })
      var items = document.querySelectorAll(".pimg");


      const itemCount = items.length;
      const itemsPerSlide = 1;
      let currentSlide = 0;

      function showSlide() {
        const startIndex = currentSlide * itemsPerSlide;
        const endIndex = startIndex + itemsPerSlide;

        items.forEach((item, index) => {
          if (index >= startIndex && index < endIndex) {
            item.style.display = 'block';
          } else {
            item.style.display = 'none';
          }
        });
      }

      function nextSlide() {
        currentSlide = (currentSlide + 1) % Math.ceil(itemCount / itemsPerSlide);
        showSlide();
      }

      function prevSlide() {
        currentSlide = (currentSlide - 1 + Math.ceil(itemCount / itemsPerSlide)) % Math.ceil(itemCount / itemsPerSlide);
        showSlide();
      }
      showSlide();
      document.querySelector('.next-btn').addEventListener('click', nextSlide);
      document.querySelector('.prev-btn').addEventListener('click', prevSlide);

    })
</script>
</body>

</html>